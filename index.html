<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sebuah Kejutan Untukmu!</title>
    <!-- Memuat Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Memuat Font Kustom dari Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Inter:wght@400;700&display=swap" rel="stylesheet">

    <style>
        /* CSS Kustom */
        body {
            background-image: url('https://feeldreams.github.io/wp11.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            font-family: 'Inter', sans-serif;
            overflow: hidden; /* Mencegah scroll saat modal aktif */
        }
        .font-display {
            font-family: 'Fredoka One', cursive;
        }
        .shadow-text {
            text-shadow: 0px 2px 4px rgba(0, 0, 0, 0.5);
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        .game-cell {
            transition: all 0.2s ease;
        }
        .game-cell:hover {
            transform: scale(1.05);
        }
        .mole {
            animation: popUp 0.3s ease;
        }
        @keyframes popUp {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- Musik Latar (TANPA AUTOPLAY DI HTML) -->
    <audio id="bgMusic" src="https://files.catbox.moe/7czehh.mp3" loop></audio>

    <!-- 
      LAYAR 1: MODAL NAMA PENGGUNA
    -->
    <div id="nameModal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4">
        <div class="bg-white bg-opacity-90 backdrop-blur-sm p-8 rounded-2xl shadow-2xl text-center w-full max-w-md animate-fade-in">
            <img src="https://feeldreams.github.io/pandapanah.gif" alt="Panda lucu" class="w-32 h-32 mx-auto mb-4 rounded-full shadow-lg">
            <h2 class="text-3xl font-display text-pink-600 mb-2">Halo, Kamu!</h2>
            <p class="text-lg mb-4">Sebelum kita mulai seru-seruan, boleh tulis nama panggilanmu dulu?</p>
            <input type="text" id="nameInput" class="w-full px-4 py-3 border-2 border-pink-300 rounded-xl text-lg text-center focus:outline-none focus:ring-2 focus:ring-pink-500" placeholder="Tulis namamu di sini...">
            <p id="nameError" class="text-red-500 text-sm mt-2 hidden">Nama nggak boleh kosong ya!</p>
            <button id="startButton" class="w-full mt-4 bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 px-6 rounded-xl text-lg transition-all transform hover:scale-105 shadow-lg">
                Lanjut!
            </button>
        </div>
    </div>

    <!-- 
      LAYAR 2: KONTEN UTAMA
    -->
    <div id="mainContent" class="hidden min-h-screen w-full p-4 md:p-8 flex flex-col items-center justify-center space-y-6 overflow-y-auto">
        
        <!-- Pesan Selamat Datang -->
        <div class="text-center animate-fade-in" style="animation-delay: 0.2s;">
            <h1 class="text-4xl md:text-6xl font-display text-white shadow-text">
                Hai, <span class="userNameDisplay text-yellow-300">Kamu</span>!
            </h1>
            <p class="text-xl md:text-2xl text-white shadow-text mt-2">Aku ada sesuatu buat nemenin harimu!</p>
            <img src="https://feeldreams.github.io/weee.gif" alt="Stiker weee" class="w-40 h-40 mx-auto mt-4">
        </div>

        <!-- Kartu "Reward" -->
        <div class="bg-white bg-opacity-90 backdrop-blur-sm p-6 rounded-2xl shadow-xl w-full max-w-lg text-center animate-fade-in" style="animation-delay: 0.4s;">
            <h3 class="text-2xl font-display text-teal-600 mb-3">Lagi Butuh Sesuatu?</h3>
            <p class="mb-4">Lagi bosen? Lagi galau? Atau malah lagi super semangat? Apapun itu, klik tombol di bawah ini buat dapetin... sebuah kejutan!</p>
            <button id="rewardButton" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-5 rounded-full text-lg transition-all transform hover:scale-105 shadow-md">
                Klik Buat Kejutan!
            </button>
        </div>

        <!-- Kartu "Minigame" -->
        <div class="bg-white bg-opacity-90 backdrop-blur-sm p-6 rounded-2xl shadow-xl w-full max-w-lg text-center animate-fade-in" style="animation-delay: 0.6s;">
            <h3 class="text-2xl font-display text-purple-600 mb-3">Minigame: Cilukba Cepat!</h3>
            <p class="mb-4">Ayo tes seberapa cepat reaksimu! Klik gambar yang muncul secepat mungkin sebelum dia hilang. Siap?</p>
            <div class="flex justify-between items-center mb-4 px-4">
                <span class="text-xl font-bold">Skor: <span id="gameScore" class="text-purple-700">0</span></span>
                <button id="startGameButton" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-5 rounded-full text-lg transition-all transform hover:scale-105 shadow-md">
                    Mulai Main!
                </button>
            </div>
            
            <div id="gameGrid" class="grid grid-cols-3 gap-3 p-2 bg-purple-100 rounded-lg">
                <!-- Sel game akan dibuat oleh JavaScript -->
            </div>
        </div>
        
    </div>

    <!-- 
      LAYAR 3: MODAL REWARD
    -->
    <div id="rewardModal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-40 p-4">
        <div class="bg-white bg-opacity-90 backdrop-blur-sm p-8 rounded-2xl shadow-2xl text-center w-full max-w-md animate-fade-in relative">
            <button id="closeRewardButton" class="absolute top-3 right-3 text-gray-500 hover:text-gray-800 text-3xl font-bold">&times;</button>
            <img src="https://feeldreams.github.io/emawh.gif" alt="Stiker peluk" class="w-40 h-40 mx-auto mb-4 rounded-lg">
            <h2 class="text-3xl font-display text-teal-600 mb-2">TADAAAAA!</h2>
            <p class="text-lg mb-4">
                Ini dia <i>virtual hug</i> dan suntikan semangat spesial buat 
                <span class="userNameDisplay font-bold">kamu</span>! 
                Semoga harimu makin seru dan menyenangkan ya! ðŸ˜‰
            </p>
        </div>
    </div>

    <!-- 
      TOMBOL MUTE/UNMUTE MUSIK (BARU)
    -->
    <button id="muteButton" class="hidden fixed bottom-4 right-4 bg-white bg-opacity-80 p-3 rounded-full shadow-lg z-50 transition-all transform hover:scale-110">
        <!-- Ikon Unmuted (Suara Aktif) -->
        <svg id="iconUnmuted" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-pink-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .89-1.077 1.337-1.707.707L5.586 15z" />
        </svg>
        <!-- Ikon Muted (Suara Mati) -->
        <svg id="iconMuted" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-500 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .89-1.077 1.337-1.707.707L5.586 15z" />
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 14l-5-5m0 5l5-5" />
        </svg>
    </button>


    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Variabel Global ---
            const nameModal = document.getElementById('nameModal');
            const mainContent = document.getElementById('mainContent');
            const rewardModal = document.getElementById('rewardModal');
            
            const startButton = document.getElementById('startButton');
            const nameInput = document.getElementById('nameInput');
            const nameError = document.getElementById('nameError');
            const userNameDisplays = document.querySelectorAll('.userNameDisplay');
            
            const rewardButton = document.getElementById('rewardButton');
            const closeRewardButton = document.getElementById('closeRewardButton');
            
            const bgMusic = document.getElementById('bgMusic');
            
            // Variabel Musik (BARU)
            const muteButton = document.getElementById('muteButton');
            const iconUnmuted = document.getElementById('iconUnmuted');
            const iconMuted = document.getElementById('iconMuted');
            let isMuted = true; // Asumsi awal di-mute
            
            // Variabel Game
            const startGameButton = document.getElementById('startGameButton');
            const gameGrid = document.getElementById('gameGrid');
            const gameScore = document.getElementById('gameScore');
            let score = 0;
            let gameActive = false;
            let gameTimer;
            let gameCells = [];

            // --- Logika Halaman Utama ---

            // 1. Logika Tombol Mulai (Modal Nama)
            startButton.addEventListener('click', () => {
                const userName = nameInput.value.trim();
                
                if (userName === "") {
                    nameError.classList.remove('hidden');
                } else {
                    nameError.classList.add('hidden');
                    userNameDisplays.forEach(span => {
                        span.textContent = userName;
                    });
                    
                    nameModal.classList.add('hidden');
                    mainContent.classList.remove('hidden');
                    document.body.style.overflow = 'auto';
                    
                    // Tampilkan tombol mute (BARU)
                    muteButton.classList.remove('hidden');
                    
                    // Coba putar musik (BARU)
                    bgMusic.play().then(() => {
                        // Berhasil! Set status jadi tidak di-mute
                        isMuted = false;
                        bgMusic.muted = false;
                        updateMuteIcon();
                    }).catch(e => {
                        // Gagal (autoplay diblokir). 
                        // Biarkan status 'isMuted = true', tapi set 'muted' di audio
                        console.warn("Autoplay ditolak. Musik dimulai dalam keadaan Mute.", e);
                        isMuted = true;
                        bgMusic.muted = true;
                        updateMuteIcon();
                        // Kita tetap coba mainkan dalam keadaan mute, agar tombol toggle berfungsi
                        bgMusic.play().catch(e => {}); 
                    });
                }
            });

            // 2. Logika Tombol Reward
            rewardButton.addEventListener('click', () => {
                rewardModal.classList.remove('hidden');
            });
            
            closeRewardButton.addEventListener('click', () => {
                rewardModal.classList.add('hidden');
            });

            // 3. Logika Tombol Mute/Unmute (BARU)
            muteButton.addEventListener('click', toggleMusic);

            function toggleMusic() {
                isMuted = !isMuted;
                bgMusic.muted = isMuted;
                
                // Jika musik dijeda (misal krn pindah tab), coba mainkan lagi
                if (!isMuted && bgMusic.paused) {
                    bgMusic.play().catch(e => console.warn("Gagal memutar musik saat unmute.", e));
                }
                
                updateMuteIcon();
            }

            function updateMuteIcon() {
                if (isMuted) {
                    iconUnmuted.classList.add('hidden');
                    iconMuted.classList.remove('hidden');
                } else {
                    iconUnmuted.classList.remove('hidden');
                    iconMuted.classList.add('hidden');
                }
            }

            // --- Logika Minigame "Cilukba" ---

            // 4. Tombol Mulai Game
            startGameButton.addEventListener('click', startGame);

            function startGame() {
                if (gameActive) return;
                gameActive = true;
                score = 0;
                gameScore.textContent = score;
                startGameButton.disabled = true;
                startGameButton.textContent = "Tunggu...";
                resetGrid();
                gameTimer = setInterval(popMole, 900);
                setTimeout(endGame, 15000);
            }
            
            // 5. Buat/Reset Grid Game
            function resetGrid() {
                gameGrid.innerHTML = '';
                gameCells = []; 
                for (let i = 0; i < 9; i++) {
                    const cell = document.createElement('div');
                    cell.className = "game-cell h-24 w-full bg-purple-200 rounded-lg cursor-pointer hover:bg-purple-300";
                    cell.addEventListener('click', whack);
                    gameGrid.appendChild(cell);
                    gameCells.push(cell);
                }
            }

            // 6. Logika Memukul "Mole" (Klik Sel)
            function whack(e) {
                if (!gameActive || !e.target.classList.contains('mole')) {
                    return;
                }
                score++;
                gameScore.textContent = score;
                e.target.classList.remove('mole');
                e.target.innerHTML = '';
            }

            // 7. Logika Memunculkan "Mole"
            function popMole() {
                const currentMole = document.querySelector('.mole');
                if (currentMole) {
                    currentMole.classList.remove('mole');
                    currentMole.innerHTML = '';
                }
                const randomCell = gameCells[Math.floor(Math.random() * gameCells.length)];
                randomCell.classList.add('mole');
                randomCell.innerHTML = `<img src="https://feeldreams.github.io/cilukba.gif" class="w-full h-full object-cover rounded-lg pointer-events-none" alt="Cilukba">`;
            }

            // 8. Logika Mengakhiri Game
            function endGame() {
                gameActive = false;
                clearInterval(gameTimer);
                startGameButton.disabled = false;
                startGameButton.textContent = "Mulai Main Lagi!";
                gameGrid.innerHTML = `
                    <div class="col-span-3 text-center p-10 text-2xl font-display text-purple-800">
                        Game Selesai!
                        <br>
                        Skor Akhirmu: ${score}
                    </div>
                `;
            }
        });
    </script>

</body>
</html>
